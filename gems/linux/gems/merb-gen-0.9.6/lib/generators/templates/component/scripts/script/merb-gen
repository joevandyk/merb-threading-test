#!/usr/bin/env ruby

# This file was generated by 'merb-gen scripts' and 
# is identical to the executable merb-gen/bin/merb-gen

# Try to use minigems instead of the fully rubygems library
begin
  require 'minigems'
rescue LoadError
  require 'rubygems'
end

# Load script helpers if available - either local or system-wide.
begin
  # Figure out the merb root - defaults to the current directory.
  root_key = %w[-m --merb-root].detect { |o| ARGV.index(o) }
  root = ARGV[ARGV.index(root_key) + 1] if root_key
  __DIR__ = root.to_a.empty? ? Dir.getwd : root
  
  # Piggyback on the merb-core rubygem for initial setup scripts.
  # Requiring it doesn't affect the local gem version of merb-core
  # we might effectively want to load here after.
  if merb_core_dir = Dir[File.join(__DIR__, 'gems', 'gems', 'merb-core-*')].last
    require File.join(merb_core_dir, 'lib', 'merb-core', 'script')
  else
    require 'merb-core/script'
  end
  # Now setup local gems to be incorporated into the normal loaded gems.
  # Unless the option --no-frozen is given, local gems are enabled.
  include Merb::ScriptHelpers
  setup_local_gems!(__DIR__)
rescue LoadError
end

require 'merb-gen'

Merb::BootLoader.after_app_loads do
  Merb::Generators.run_cli(Dir.pwd, 'merb-gen', Merb::VERSION, ARGV)
end

Merb.start :environment => 'development', :log_level => 'error'